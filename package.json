{
  "name": "authentication-service",
  "version": "2.4.0",
  "type": "module",
  "description": "High-performance JWT authentication service built with Bun",
  "main": "build/dist/server.js",
  "scripts": {
    "dev": "bun --watch src/index.ts",
    "dev:clean": "bun run server:kill && bun run dev",
    "dev:docs": "bun run docs:generate && bun --watch src/server.ts",
    "dev:env:development": "bun run docs:generate && cp .env.dev .env.development && NODE_ENV=development bun src/server.ts; rm .env.development",
    "dev:env:staging": "bun run docs:generate && cp .env.stg .env.staging && NODE_ENV=staging bun src/server.ts; rm .env.staging",
    "dev:env:production": "bun run docs:generate && cp .env.prod .env.production && NODE_ENV=production bun src/server.ts; rm .env.production",
    "start": "bun run src/index.ts",
    "start:server": "bun run src/server.ts",
    "build": "bun build src/index.ts --outdir=./build/dist --target=bun --minify",
    "build:server": "bun build src/server.ts --target=bun --outdir=build/dist --minify",
    "biome:check": "biome check .",
    "biome:check:changed": "biome check --changed",
    "biome:check:performance": "time biome check . --max-diagnostics=50",
    "biome:check:unsafe": "biome check --write --unsafe .",
    "biome:check:write": "biome check --write .",
    "biome:ci": "biome ci .",
    "biome:format": "biome format .",
    "biome:format:write": "biome format --write .",
    "biome:lint": "biome lint .",
    "biome:lint:fix": "biome lint --write .",
    "lint:all": "bun run biome:check && bun run yaml:check",
    "lint:fix": "bun run quality:fix && bun run yaml:check",
    "quality:check": "bun run typecheck && bun run biome:check && bun run yaml:check",
    "quality:fix": "bun run biome:check:write && bun run typecheck",
    "typecheck": "tsc --noEmit",
    "yaml:check": "yamllint .github/workflows/*.yml",
    "test:bun": "bun test",
    "test:bun:concurrent": "bun test --max-concurrency=4",
    "test:bun:coverage": "bun test --coverage ./test/bun",
    "test:bun:coverage:ci": "mkdir -p coverage && bun test --coverage --coverage-reporter=lcov --coverage-reporter=text --coverage-dir=coverage ./test/bun",
    "test:bun:coverage:lcov": "mkdir -p coverage && bun test --coverage --coverage-reporter=lcov --coverage-dir=coverage ./test/bun",
    "test:bun:seed": "bun test --seed",
    "test:bun:watch": "bun test --watch",
    "test:e2e": "playwright test",
    "test:e2e:ui": "playwright test --ui",
    "test:k6:info": "bun run test/k6/run-all-tests.ts",
    "test:k6:quick": "bun run test:k6:smoke:health && bun run test:k6:smoke:tokens",
    "test:k6:quick:ci": "bun run test:k6:ci",
    "test:k6:ci": "test/k6/run-k6.sh test/k6/smoke/ci-safe-smoke.ts test/results/k6/ci-safe-results.json false",
    "test:k6:smoke:all-endpoints": "test/k6/run-k6.sh test/k6/smoke/all-endpoints-smoke.ts test/results/k6/smoke-all-endpoints-results.json false",
    "test:k6:smoke:health": "test/k6/run-k6.sh test/k6/smoke/health-only-smoke.ts test/results/k6/smoke-health-only-results.json false",
    "test:k6:smoke:metrics": "test/k6/run-k6.sh test/k6/smoke/metrics-only-smoke.ts test/results/k6/smoke-metrics-only-results.json false",
    "test:k6:smoke:openapi": "test/k6/run-k6.sh test/k6/smoke/openapi-only-smoke.ts test/results/k6/smoke-openapi-only-results.json false",
    "test:k6:smoke:profiling": "test/k6/run-k6.sh test/k6/smoke/profiling-smoke.ts test/results/k6/smoke-profiling-results.json false",
    "test:k6:smoke:tokens": "test/k6/run-k6.sh test/k6/smoke/tokens-smoke.ts test/results/k6/smoke-tokens-results.json true",
    "test:k6:load": "test/k6/run-k6.sh test/k6/load/auth-load.ts test/results/k6/load-auth-results.json true",
    "test:k6:spike": "test/k6/run-k6.sh test/k6/spike/spike-test.ts test/results/k6/spike-test-results.json true",
    "test:k6:stress": "test/k6/run-k6.sh test/k6/stress/system-stress.ts test/results/k6/stress-system-results.json true",
    "test:k6:soak": "test/k6/run-k6.sh test/k6/soak/auth-service-soak.ts test/results/k6/soak-results.json true",
    "test:k6:soak:full": "K6_SOAK_DURATION=4h test/k6/run-k6.sh test/k6/soak/auth-service-soak.ts test/results/k6/soak-full-results.json true",
    "test:k6:soak:quick": "K6_SOAK_DURATION=30m test/k6/run-k6.sh test/k6/soak/auth-service-soak.ts test/results/k6/soak-quick-results.json true",
    "test:k6:pressure:memory": "test/k6/run-k6.sh test/k6/soak/memory-pressure-extended.ts test/results/k6/memory-pressure-results.json false",
    "test:k6:pressure:memory:demo": "K6_THRESHOLDS_NON_BLOCKING=true K6_SOAK_TOTAL_DURATION=3m K6_SOAK_WARMUP_DURATION=30s K6_SOAK_RAMPUP_DURATION=30s K6_SOAK_PEAK_DURATION=1m K6_SOAK_SUSTAINED_DURATION=30s test/k6/run-k6.sh test/k6/soak/memory-pressure-extended.ts test/results/k6/memory-pressure-demo-results.json false",
    "test:k6:pressure:memory:quick": "K6_THRESHOLDS_NON_BLOCKING=true K6_SOAK_TOTAL_DURATION=5m K6_SOAK_WARMUP_VUS=1 K6_SOAK_TARGET_VUS=3 K6_SOAK_PEAK_VUS=5 K6_SOAK_PRESSURE_VUS=8 test/k6/run-k6.sh test/k6/soak/memory-pressure-extended.ts test/results/k6/memory-pressure-quick-results.json false",
    "test:k6:full": "bun run test:k6:smoke:health && bun run test:k6:smoke:metrics && bun run test:k6:smoke:openapi && bun run test:k6:smoke:tokens && bun run test:k6:load && bun run test:k6:stress && bun run test:k6:spike",
    "test:mutation": "mkdir -p test/results/mutation && stryker run",
    "test:mutation:fresh": "mkdir -p test/results/mutation && rm -f test/results/mutation/stryker-incremental.json && stryker run",
    "test:mutation:quick": "mkdir -p test/results/mutation && stryker run --concurrency 2 --mutate 'src/services/**/*.ts'",
    "test:mutation:dry": "stryker run --dryRunOnly",
    "test:mutation:dry:debug": "DEBUG=1 ./scripts/bun-mutation-runner.sh test --reporter=dots ./test/bun",
    "test:mutation:handlers": "mkdir -p test/results/mutation && stryker run --mutate 'src/handlers/**/*.ts'",
    "test:mutation:services": "mkdir -p test/results/mutation && stryker run --mutate 'src/services/**/*.ts'",
    "test:mutation:telemetry": "mkdir -p test/results/mutation && stryker run --mutate 'src/telemetry/**/*.ts'",
    "test:mutation:config": "mkdir -p test/results/mutation && stryker run --mutate 'src/config/**/*.ts'",
    "test:mutation:adapters": "mkdir -p test/results/mutation && stryker run --mutate 'src/adapters/**/*.ts'",
    "test:mutation:cache": "mkdir -p test/results/mutation && stryker run --mutate 'src/cache/**/*.ts'",
    "test:mutation:utils": "mkdir -p test/results/mutation && stryker run --mutate 'src/utils/**/*.ts'",
    "test:mutation:errors": "mkdir -p test/results/mutation && stryker run --mutate 'src/errors/**/*.ts'",
    "test:integration": "bun test test/integration/",
    "test:integration:circuit": "bun test test/integration/circuit-breaker.integration.test.ts",
    "test:integration:full": "bun run test:integration:docker:up && sleep 30 && bun run test:integration:seed && bun run test:integration:test",
    "test:integration:kong": "bun test test/integration/kong-service.integration.test.ts",
    "test:integration:seed": "KONG_ADMIN_URL=http://localhost:8101 bun scripts/seed-test-consumers.ts",
    "test:integration:test": "bun test test/integration/",
    "test:integration:docker:down": "docker compose -f docker-compose.test.yml down",
    "test:integration:docker:logs": "docker compose -f docker-compose.test.yml logs -f",
    "test:integration:docker:up": "docker compose -f docker-compose.test.yml up -d",
    "test:integration:docker:clean": "docker compose -f docker-compose.test.yml down -v --remove-orphans",
    "test:clean": "rm -rf test/results/k6/* test/results/playwright/* test/results/bun/* test/results/mutation/* test-results/ playwright-report/",
    "test:suite": "bun run test:bun && bun run test:e2e && bun run test:k6:quick",
    "test:suite:ci": "bun run test:bun && bun run test:e2e && bun run test:k6:quick:ci",
    "test:mutation:with-kong": "bun scripts/run-mutation-with-kong.ts",
    "test:mutation:with-kong:fresh": "bun scripts/run-mutation-with-kong.ts --fresh",
    "test:mutation:with-kong:keep": "bun scripts/run-mutation-with-kong.ts --keep-running",
    "docker:build": "./scripts/docker-build.sh",
    "docker:build:size-report": "docker images ${npm_package_name}:latest --format 'table {{.Repository}}\\t{{.Tag}}\\t{{.Size}}\\t{{.CreatedAt}}'",
    "docker:run:local": "docker run --rm --env-file .env -p 3000:3000 --name auth-service-local authentication-service:latest",
    "docker:run:dev": "docker run --rm --env-file .env.dev -p 3001:3000 --name auth-service-dev authentication-service:latest",
    "docker:run:staging": "docker run --rm --env-file .env.stg -p 3002:3000 --name auth-service-staging authentication-service:latest",
    "docker:run:production": "docker run -d --restart=always --env-file .env.prod -p 3000:3000 --user 65532:65532 --read-only --tmpfs /tmp:noexec,nosuid,size=100m --cap-drop=ALL --security-opt=no-new-privileges:true --name auth-service-prod authentication-service:latest",
    "docker:stop:local": "docker stop auth-service-local 2>/dev/null || true",
    "docker:stop:dev": "docker stop auth-service-dev 2>/dev/null || true",
    "docker:stop:staging": "docker stop auth-service-staging 2>/dev/null || true",
    "docker:stop:production": "docker stop auth-service-prod 2>/dev/null || true",
    "docker:local": "bun run docker:stop:local && bun run docker:build && bun run docker:run:local",
    "docker:dev": "bun run docker:stop:dev && bun run docker:build && bun run docker:run:dev",
    "docker:staging": "bun run docker:stop:staging && bun run docker:build && bun run docker:run:staging",
    "docker:production": "bun run docker:stop:production && bun run docker:build && bun run docker:security:validate && bun run docker:run:production",
    "docker:security:full": "bun run docker:security:hadolint && bun run docker:build && bun run docker:security:trivy && bun run docker:security:validate",
    "docker:security:hadolint": "hadolint Dockerfile --config .hadolint.yaml",
    "docker:security:hadolint:docker": "docker run --rm -i hadolint/hadolint --config /dev/stdin < .hadolint.yaml < Dockerfile",
    "docker:security:scan": "docker scout cves ${npm_package_name}:latest",
    "docker:security:score": "./scripts/validate-dockerfile-security.sh && echo 'Security validation completed'",
    "docker:security:trivy": "trivy image --exit-code 1 --severity HIGH,CRITICAL authentication-service:latest",
    "docker:security:trivy:runtime": "trivy image --ignore-unfixed --severity HIGH,CRITICAL authentication-service:latest",
    "docker:security:validate": "./scripts/validate-dockerfile-security.sh",
    "docker:security:verify:runtime": "./scripts/verify-runtime-security.sh authentication-service:latest",
    "docker:optimize:build": "./scripts/docker-optimize-build.sh",
    "docker:optimize:full": "./scripts/docker-optimize-build.sh && ./scripts/validate-docker-optimization.sh",
    "docker:optimize:validate": "./scripts/validate-docker-optimization.sh",
    "docker:compose:down": "docker-compose -f docker-compose.production.yml down",
    "docker:compose:prod": "docker-compose -f docker-compose.production.yml up -d",
    "redis:start": "docker run -d --name auth-redis -p 6379:6379 --restart unless-stopped redis:7-alpine redis-server --appendonly yes --maxmemory 128mb --maxmemory-policy allkeys-lru",
    "redis:stop": "docker stop auth-redis 2>/dev/null || true",
    "redis:remove": "docker rm auth-redis 2>/dev/null || true",
    "redis:restart": "bun run redis:stop && bun run redis:remove && bun run redis:start",
    "redis:setup": "bun run redis:stop && bun run redis:remove && bun run redis:start && echo 'Redis started on localhost:6379'",
    "redis:cli": "docker exec -it auth-redis redis-cli",
    "redis:logs": "docker logs -f auth-redis",
    "redis:status": "docker ps --filter name=auth-redis --format 'table {{.Names}}\\t{{.Status}}\\t{{.Ports}}'",
    "redis:stats": "docker exec -it auth-redis redis-cli --stat",
    "redis:bigkeys": "docker exec -it auth-redis redis-cli --bigkeys",
    "redis:memkeys": "docker exec -it auth-redis redis-cli --memkeys",
    "redis:scan": "docker exec -it auth-redis redis-cli --scan | head -10",
    "redis:scan:auth": "docker exec -it auth-redis redis-cli --scan --pattern '*auth_service*'",
    "profile:start": "PROFILING_ENABLED=true bun --inspect src/server.ts",
    "profile:dev": "NODE_ENV=development PROFILING_ENABLED=true bun --inspect src/server.ts",
    "profile:status": "curl -s http://localhost:3000/debug/profiling/status",
    "profile:start-session": "curl -X POST http://localhost:3000/debug/profiling/start",
    "profile:stop-session": "curl -X POST http://localhost:3000/debug/profiling/stop",
    "profile:reports": "curl -s http://localhost:3000/debug/profiling/reports",
    "profile:clean": "curl -X POST http://localhost:3000/debug/profiling/cleanup",
    "profile:help": "echo 'Profiling Commands:' && echo '  bun run profile:start          - Start server with profiling enabled and Chrome DevTools' && echo '  bun run profile:dev            - Start development server with profiling and Chrome DevTools' && echo '  bun run profile:status         - Check profiling status' && echo '  bun run profile:start-session  - Start profiling session' && echo '  bun run profile:stop-session   - Stop profiling session' && echo '  bun run profile:reports        - List available reports' && echo '  bun run profile:clean          - Clean profiling artifacts' && echo '  bun run profile:k6:smoke       - Profile K6 smoke tests' && echo '  bun run profile:k6:load-test   - Profile K6 load tests' && echo '  bun run profile:k6:stress      - Profile K6 stress tests' && echo 'Chrome DevTools: Navigate to chrome://inspect or use the Bun Inspector URL shown at startup'",
    "profile:k6:smoke": "PROFILING_ENABLED=true bun src/server.ts & sleep 3 && curl -X POST http://localhost:3000/debug/profiling/start && bun run test:k6:smoke:profiling && curl -X POST http://localhost:3000/debug/profiling/stop && curl -X POST http://localhost:3000/debug/profiling/cleanup",
    "profile:k6:load-test": "PROFILING_ENABLED=true bun src/server.ts & sleep 5 && curl -X POST http://localhost:3000/debug/profiling/start && bun run test:k6:load && curl -X POST http://localhost:3000/debug/profiling/stop && curl -X POST http://localhost:3000/debug/profiling/cleanup",
    "profile:k6:stress": "PROFILING_ENABLED=true bun src/server.ts & sleep 5 && curl -X POST http://localhost:3000/debug/profiling/start && bun run test:k6:stress && curl -X POST http://localhost:3000/debug/profiling/stop && curl -X POST http://localhost:3000/debug/profiling/cleanup",
    "kong:simulator": "bun test/kong-simulator/kong-proxy.ts",
    "kong:simulator:docker": "docker-compose -f docker-compose.kong.yml up -d",
    "kong:simulator:stop": "docker-compose -f docker-compose.kong.yml down",
    "kong:test": "bun run kong:simulator & sleep 2 && curl -H 'X-API-Key: test-api-key-consumer-001' http://localhost:8000/tokens || true && pkill -f kong-proxy.ts",
    "kong:test:with-auth": "curl -H 'X-API-Key: test-api-key-consumer-001' http://localhost:8000/tokens",
    "kong:test:health": "curl http://localhost:8000/health",
    "docs:generate": "bun scripts/generate-openapi.ts",
    "license:check": "bun scripts/license-check.ts",
    "license:check:json": "bun scripts/license-check.ts --json",
    "license:check:strict": "bun scripts/license-check.ts --fail-on-warnings",
    "license:check:verbose": "bun scripts/license-check.ts --verbose",
    "server:health-check": "curl -f http://localhost:3000/health || exit 1",
    "server:kill": "lsof -ti :3000 | xargs kill -9 2>/dev/null || echo 'No processes found on port 3000'",
    "fix:bun-symlink": "rm -f node_modules/.bin/bun && echo 'Removed broken bun symlink'",
    "fix:bun-full": "rm -rf ~/.bun/install/cache node_modules bun.lockb && bun install && rm -f node_modules/.bin/bun"
  },
  "keywords": [
    "authentication",
    "jwt",
    "kong",
    "bun",
    "typescript",
    "microservice"
  ],
  "author": "Simon Owusu",
  "license": "UNLICENSED",
  "devDependencies": {
    "@biomejs/biome": "^2.3.11",
    "@playwright/test": "^1.57.0",
    "@stryker-mutator/core": "^9.4.0",
    "@stryker-mutator/typescript-checker": "^9.4.0",
    "@types/bun": "1.3.6",
    "@types/k6": "^1.5.0",
    "@types/opossum": "^8.1.9",
    "@types/redis": "^4.0.11",
    "js-yaml": "^4.1.1",
    "stryker-mutator-bun-runner": "^0.4.0",
    "typescript": "^5.9.3",
    "undici": "^7.18.2",
    "yaml-lint": "^1.7.0"
  },
  "engines": {
    "bun": ">=1.1.35"
  },
  "bun": {
    "install": {
      "peer": true,
      "frozenLockfile": true,
      "production": false
    },
    "build": {
      "target": "bun",
      "minify": true,
      "sourcemap": "external",
      "splitting": false,
      "format": "esm"
    }
  },
  "overrides": {
    "@opentelemetry/api": "^1.9.0",
    "@opentelemetry/core": "^2.1.0",
    "@opentelemetry/resources": "^2.1.0",
    "@opentelemetry/sdk-metrics": "^2.1.0",
    "@opentelemetry/sdk-trace-base": "^2.1.0",
    "@opentelemetry/semantic-conventions": "^1.37.0",
    "semver": "^7.6.3",
    "protobufjs": "^7.4.0"
  },
  "resolutions": {
    "@opentelemetry/api": "^1.9.0",
    "@opentelemetry/core": "^2.1.0",
    "@opentelemetry/resources": "^2.1.0",
    "@opentelemetry/sdk-metrics": "^2.1.0",
    "@opentelemetry/sdk-trace-base": "^2.1.0",
    "@opentelemetry/semantic-conventions": "^1.37.0",
    "semver": "^7.6.3",
    "protobufjs": "^7.4.0"
  },
  "dependencies": {
    "@elastic/ecs-winston-format": "^1.5.3",
    "@opentelemetry/api": "^1.9.0",
    "@opentelemetry/api-logs": "^0.210.0",
    "@opentelemetry/auto-instrumentations-node": "^0.68.0",
    "@opentelemetry/core": "^2.4.0",
    "@opentelemetry/exporter-logs-otlp-http": "^0.210.0",
    "@opentelemetry/exporter-metrics-otlp-http": "^0.210.0",
    "@opentelemetry/exporter-otlp-http": "^0.26.0",
    "@opentelemetry/exporter-trace-otlp-http": "^0.210.0",
    "@opentelemetry/host-metrics": "^0.38.1",
    "@opentelemetry/instrumentation-fetch": "^0.210.0",
    "@opentelemetry/instrumentation-http": "^0.210.0",
    "@opentelemetry/instrumentation-redis": "^0.58.0",
    "@opentelemetry/instrumentation-winston": "^0.54.0",
    "@opentelemetry/resources": "^2.4.0",
    "@opentelemetry/sdk-logs": "^0.210.0",
    "@opentelemetry/sdk-metrics": "^2.4.0",
    "@opentelemetry/sdk-node": "^0.210.0",
    "@opentelemetry/sdk-trace-base": "^2.4.0",
    "@opentelemetry/semantic-conventions": "^1.39.0",
    "@opentelemetry/winston-transport": "^0.20.0",
    "opossum": "^9.0.0",
    "redis": "^5.10.0",
    "winston": "^3.19.0",
    "winston-transport": "^4.9.0",
    "zod": "^4.3.5"
  },
  "trustedDependencies": [
    "protobufjs"
  ]
}
