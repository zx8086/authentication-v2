# Snyk (https://snyk.io) policy file

version: v1.25.0

# Ignore specific vulnerabilities
ignore:
  # FALSE POSITIVE: Environment variable KEY NAMES in envMapping.ts
  # These are not secrets - they're the names of environment variables to read
  'SNYK-JS-ENVM APPING-CWE547-001':
    - '*':
        reason: 'Environment variable names (KONG_ADMIN_TOKEN, etc.) are configuration keys, not actual secrets'
        expires: 2027-12-31T00:00:00.000Z

  # FALSE POSITIVE: Obvious placeholder in defaults.ts
  # The value "REPLACE_WITH_ACTUAL_KONG_ADMIN_TOKEN" is a documentation placeholder
  'SNYK-JS-DEFAULTS-CWE547-001':
    - '*':
        reason: 'String "REPLACE_WITH_ACTUAL_KONG_ADMIN_TOKEN" is an obvious placeholder for documentation, not a real secret'
        expires: 2027-12-31T00:00:00.000Z

  # FALSE POSITIVE: Test data in test files
  # These are hardcoded test values for unit/integration testing
  'SNYK-JS-TEST-CWE547':
    - 'test/**':
        reason: 'Test files contain hardcoded test data for assertions - not production secrets'
        expires: 2027-12-31T00:00:00.000Z

  # JUSTIFIED: Test credentials in kong-mode-strategies.test.ts
  # Values like "test-token-123" and "kpat-token-123" are clearly test data
  SNYK-JS-KONGMODESTRATEGIES-CWE547:
    - 'test/bun/kong/kong-mode-strategies.test.ts':
        reason: 'Test file with obvious test data ("test-token-123", "kpat-token-123") for unit testing Kong adapters'
        expires: 2027-12-31T00:00:00.000Z

  # JUSTIFIED: Test JWT tokens and secrets in mutation tests
  # Mutation testing requires hardcoded test data for validation logic
  SNYK-JS-JWTMUTATION-CWE547:
    - 'test/bun/mutation/jwt.mutation.test.ts':
        reason: 'Mutation test file with hardcoded test JWTs and wrong secrets to verify validation logic'
        expires: 2027-12-31T00:00:00.000Z

  # JUSTIFIED: Test secrets in mutation-killer.test.ts
  # Wrong secrets used to test negative cases
  SNYK-JS-MUTATIONKILLER-CWE547:
    - 'test/bun/mutation/mutation-killer.test.ts':
        reason: 'Mutation test with wrong secrets to verify error handling ("wrong-secret-that-is-at-least-45-characters-long-here")'
        expires: 2027-12-31T00:00:00.000Z

  # JUSTIFIED: Test secrets in jwt.service.test.ts
  # Unit test for JWT service with hardcoded test data
  SNYK-JS-JWTSERVICE-CWE547:
    - 'test/bun/services/jwt.service.test.ts':
        reason: 'Unit test for JWT service with obvious test data ("wrong-secret-key-that-is-different")'
        expires: 2027-12-31T00:00:00.000Z

  # JUSTIFIED: Circuit breaker test with real consumer secret pattern
  # Uses ConsumerSecret type for type-safe testing
  SNYK-JS-CIRCUITBREAKER-CWE547:
    - 'test/bun/circuit-breaker/circuit-breaker-per-operation.test.ts':
        reason: 'Circuit breaker test using ConsumerSecret factory pattern for realistic test data'
        expires: 2027-12-31T00:00:00.000Z

  # JUSTIFIED: Kong adapter fetch test with JWT credentials
  # Mock JWT credential data for testing Kong API responses
  SNYK-JS-KONGADAPTERFETCH-CWE547:
    - 'test/bun/kong/kong-adapter-fetch.test.ts':
        reason: 'Test file with mock JWT credentials for verifying Kong adapter fetch logic'
        expires: 2027-12-31T00:00:00.000Z

# Patch and upgrade settings
patch: {}
